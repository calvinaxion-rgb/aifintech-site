<!-- public/dashboard.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dashboard - AIFinTech</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="max-w-6xl mx-auto p-6">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-bold">Financial Dashboard</h1>
      <select id="langSwitch" class="select select-sm">
        <option value="en">ğŸŒ EN</option>
        <option value="zh-CN">ğŸ‡¨ğŸ‡³ ç®€</option>
        <option value="zh-TW">ğŸ‡¹ğŸ‡¼ ç¹</option>
      </select>
    </div>

    <div id="modules" class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- å‹•æ…‹è¼‰å…¥å…§å®¹ -->
    </div>
  </div>

  <script src="/js/i18n.js"></script>
  <script>
    const MODULES = ['macro', 'stocks', 'crypto', 'news', 'portfolio'];
    const API_KEY = localStorage.getItem('api_key') || 'demo'; // demo æ¨¡å¼

    async function loadModule(module) {
      const lang = getLang();
      const url = `/api/v1/${lang}/${module}`;
      try {
        const res = await fetch(url, {
          headers: { 'X-API-Key': API_KEY }
        });
        const data = await res.json();
        return `<div class="card bg-base-200 p-4">
          <h2 class="text-xl font-bold mb-2">${data.title || module}</h2>
          <p>${data.content || 'Loading...'}</p>
          <p class="text-sm text-gray-500 mt-2">Updated: ${data.timestamp}</p>
        </div>`;
      } catch (e) {
        return `<div class="card bg-error p-4">Error loading ${module}</div>`;
      }
    }

    async function renderDashboard() {
      const modulesEl = document.getElementById('modules');
      const cards = await Promise.all(MODULES.map(loadModule));
      modulesEl.innerHTML = cards.join('');
    }

    // åˆå§‹åŒ–
    document.getElementById('langSwitch').value = getLang();
    document.getElementById('langSwitch').onchange = () => {
      setLang(document.getElementById('langSwitch').value);
      renderDashboard();
    };
    renderDashboard();
// èªè¨€è®Šæ›´æ™‚é‡æ–°æ¸²æŸ“
  window.addEventListener('languageChanged', renderDashboard);

  // åˆå§‹æ¸²æŸ“
  renderDashboard();
</script>
  </script>
</body>
</html>